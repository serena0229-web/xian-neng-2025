<!DOCTYPE html>
<html lang="zh-Hant">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>æ™›èƒ½å°¾ç‰™ï¼šè½‰ç›¤ç©åˆ†ç”Ÿå­˜è³½</title>
    <style>
        :root {
            --neon-gold: #ffea00;
            --neon-red: #ff003c;
            --bg-dark: #0a0a0c;
        }
        body { 
            background: var(--bg-dark); color: white; margin: 0; padding: 10px;
            font-family: -apple-system, "Microsoft JhengHei", sans-serif;
            display: flex; flex-direction: column; align-items: center; min-height: 100vh;
        }
        h1 { font-size: 1.5rem; color: var(--neon-gold); text-shadow: 0 0 10px #ffea00; margin: 10px 0; }

        /* 20äººå°è½‰ç›¤ç¶²æ ¼ */
        .battle-grid {
            display: grid; grid-template-columns: repeat(4, 1fr); gap: 8px; width: 100%; max-width: 500px;
        }
        .slot-card {
            background: #1a1a1e; border: 1px solid #333; border-radius: 8px;
            padding: 10px 2px; text-align: center; position: relative; overflow: hidden;
        }
        .slot-card.spinning { border-color: var(--neon-red); animation: pulse 0.2s infinite; }
        .slot-name { font-size: 0.8rem; display: block; margin-bottom: 5px; color: #ccc; }
        .slot-count { font-size: 1.5rem; font-weight: 900; color: var(--neon-gold); }

        /* æ—‹è½‰å‹•ç•«ç¸®åœ– */
        .mini-wheel {
            width: 30px; height: 30px; border: 2px solid var(--neon-gold);
            border-radius: 50%; margin: 0 auto; border-top-color: transparent;
            animation: none;
        }
        .spinning .mini-wheel { animation: spin 0.3s linear infinite; }

        /* æ§åˆ¶å€ */
        .footer { margin: 20px 0; width: 100%; display: flex; justify-content: center; }
        #start-btn {
            width: 80%; background: linear-gradient(45deg, #ff003c, #ffea00);
            border: none; padding: 18px; font-size: 1.5rem; font-weight: 900;
            border-radius: 50px; color: #000; box-shadow: 0 0 20px rgba(255,0,60,0.5);
        }

        /* ç²å‹è€…å…¨è¢å¹•é–‹ç */
        #winner-overlay {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(0,0,0,0.95); display: none; flex-direction: column;
            align-items: center; justify-content: center; z-index: 100;
            text-align: center;
        }
        .winner-title { color: var(--neon-gold); font-size: 2rem; margin-bottom: 10px; }
        .winner-name { 
            font-size: 5rem; color: #fff; text-shadow: 0 0 30px var(--neon-red);
            animation: bounce 0.5s infinite alternate;
        }
        .close-win-btn { margin-top: 30px; padding: 10px 30px; background: #fff; color: #000; border-radius: 20px; border: none; font-weight: bold; }

        @keyframes spin { from { transform: rotate(0deg); } to { transform: rotate(360deg); } }
        @keyframes pulse { 0% { background: #1a1a1e; } 50% { background: #300; } 100% { background: #1a1a1e; } }
        @keyframes bounce { from { transform: scale(1); } to { transform: scale(1.1); } }
    </style>
</head>
<body>

    <h1>âš¡ æ™›èƒ½ç©åˆ†å¤§é€ƒæ®º âš¡</h1>
    <div id="round-text" style="color: #888; margin-bottom: 10px;">æŒ‰ä¸‹æŒ‰éˆ•ï¼Œå…¨é«” 23äººåŒæ­¥è½‰å‹•ï¼</div>

    <div class="battle-grid" id="grid"></div>

    <div class="footer">
        <button id="start-btn" onclick="startBattle()">å…¨å“¡å•Ÿå‹•ï¼</button>
    </div>

    <div id="winner-overlay">
        <div class="winner-title">ğŸ‘‘ æœ€çµ‚æœ€é«˜ç¥¨ ğŸ‘‘</div>
        <div class="winner-name" id="win-name">èŠ³èŠ³å§</div>
        <div style="font-size: 1.5rem; color: var(--neon-gold); margin-top: 10px;">æ­å–œç²å¾—å¤§çï¼</div>
        <button class="close-win-btn" onclick="closeWinner()">å›åˆ°æˆ°å ´</button>
    </div>

    <script>
        const names = ["é¡§å•", "ä½³ä½³", "å¯Œå“¥", "é™³å§", "æ°‘æ°‘", "å‚‘æ£®", "å°é›ª", "æ€æ¬£", "é˜¿éƒ", "Amyå§", "åº·é›„", "ä½©èŒ¹", "ç¾å¿å§", "ç´èŠ¬å§", "å¨¥å¦¹", "å®¶èˆˆå“¥", "é„­å§”å“¡", "å¹¸ç¦ç”·äºº", "æ¦›æ¦›", "èŠ³èŠ³å§", "çµ²æ·‡", "ä¿¡é–", "å“å›"];
        let scores = {};
        let audioCtx;

        function initAudio() { if (!audioCtx) audioCtx = new (window.AudioContext || window.webkitAudioContext)(); }

        // æ’­æ”¾æ­¡å‘¼è² (å¤šé »ç‡åˆæˆ)
        function playCheers() {
            const freqs = [261.6, 329.6, 392, 523.2];
            freqs.forEach((f, i) => {
                const osc = audioCtx.createOscillator();
                const gain = audioCtx.createGain();
                osc.type = 'triangle';
                osc.frequency.setValueAtTime(f, audioCtx.currentTime + (i * 0.1));
                gain.gain.setValueAtTime(0.2, audioCtx.currentTime);
                gain.gain.exponentialRampToValueAtTime(0.01, audioCtx.currentTime + 1.5);
                osc.connect(gain); gain.connect(audioCtx.destination);
                osc.start(); osc.stop(audioCtx.currentTime + 1.5);
            });
        }

        function playTick() {
            const osc = audioCtx.createOscillator();
            const gain = audioCtx.createGain();
            osc.frequency.setValueAtTime(150, audioCtx.currentTime);
            gain.gain.setValueAtTime(0.1, audioCtx.currentTime);
            osc.connect(gain); gain.connect(audioCtx.destination);
            osc.start(); osc.stop(audioCtx.currentTime + 0.05);
        }

        // åˆå§‹åŒ– 20 å€‹å°æˆ°ä½
        const grid = document.getElementById('grid');
        names.forEach(n => {
            scores[n] = 0;
            grid.innerHTML += `
                <div class="slot-card" id="card-${n}">
                    <span class="slot-name">${n}</span>
                    <div class="mini-wheel"></div>
                    <div class="slot-count" id="score-${n}">0</div>
                </div>
            `;
        });

        async function startBattle() {
            initAudio();
            const btn = document.getElementById('start-btn');
            btn.disabled = true;
            
            // é‡ç½®åˆ†æ•¸
            names.forEach(n => {
                scores[n] = 0;
                document.getElementById(`score-${n}`).innerText = 0;
                document.getElementById(`card-${n}`).classList.add('spinning');
            });

            // ç¸½å…±è·‘ 40 æ¬¡éš¨æ©Ÿåˆ†é…
            const totalSteps = 40;
            for (let i = 0; i < totalSteps; i++) {
                const lucky = names[Math.floor(Math.random() * names.length)];
                scores[lucky]++;
                document.getElementById(`score-${lucky}`).innerText = scores[lucky];
                
                playTick();
                // é€Ÿåº¦è¶Šä¾†è¶Šå¿«
                await new Promise(r => setTimeout(r, Math.max(50, 200 - (i * 5))));
            }

            // çµæŸè½‰å‹•
            names.forEach(n => document.getElementById(`card-${n}`).classList.remove('spinning'));

            // æ‰¾æœ€é«˜ç¥¨
            const winner = Object.keys(scores).reduce((a, b) => scores[a] > scores[b] ? a : b);
            
            // å»¶é²ä¸€ä¸‹å…¬ä½ˆï¼Œç‡Ÿé€ æ‡¸å¿µ
            setTimeout(() => {
                showWinner(winner);
            }, 800);
        }

        function showWinner(name) {
            document.getElementById('win-name').innerText = name;
            document.getElementById('winner-overlay').style.display = 'flex';
            playCheers();
            
            // éœ‡å‹• (è‹¥æ‰‹æ©Ÿæ”¯æ´)
            if (window.navigator.vibrate) window.navigator.vibrate([200, 100, 200]);
        }

        function closeWinner() {
            document.getElementById('winner-overlay').style.display = 'none';
            document.getElementById('start-btn').disabled = false;
        }
    </script>
</body>
</html>



